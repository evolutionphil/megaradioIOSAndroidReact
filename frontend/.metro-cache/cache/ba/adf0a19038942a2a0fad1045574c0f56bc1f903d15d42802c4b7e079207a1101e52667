{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":73,"index":73}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":74},"end":{"line":2,"column":40,"index":114}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"../constants/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":115},"end":{"line":3,"column":48,"index":163}}],"key":"ZV0ujAFjHVGmM4aJSYIlDaiTRjE=","exportNames":["*"],"imports":1}},{"name":"../store/authStore","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":28,"column":29,"index":990},"end":{"line":28,"column":58,"index":1019}}],"key":"x4jghCEnTqsoIMgJBq6IvUNyemw=","exportNames":["*"],"imports":1,"isOptional":true}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _axios = require(_dependencyMap[1], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _reactNative = require(_dependencyMap[2], \"react-native\");\n  var _constantsApi = require(_dependencyMap[3], \"../constants/api\");\n  // MegaRadio Internal API Key - unlimited, no rate limiting\n  var MEGARADIO_API_KEY = 'mr_VUzdIUHuXaagvWUC208Vzi_3lqEV1Vzw';\n\n  // For web preview, we cannot use credentials due to CORS\n  // Native apps will handle cookies differently\n  var isWeb = _reactNative.Platform.OS === 'web';\n\n  // Create axios instance with API key and cookie support\n  var api = axios.default.create({\n    baseURL: _constantsApi.API_BASE_URL,\n    timeout: 30000,\n    headers: {\n      'Content-Type': 'application/json',\n      'X-API-Key': MEGARADIO_API_KEY\n    },\n    // Only use credentials on native platforms where CORS isn't an issue\n    withCredentials: !isWeb\n  });\n\n  // Helper to get auth token (lazy import to avoid circular dependency)\n  var getAuthToken = () => {\n    try {\n      // Dynamic import of authStore to avoid circular dependency\n      var _require = require(_dependencyMap[4], \"../store/authStore\"),\n        useAuthStore = _require.useAuthStore;\n      var token = useAuthStore.getState().token;\n      console.log('[API] getAuthToken called, token exists:', !!token, token ? token.substring(0, 15) + '...' : 'null');\n      return token;\n    } catch (err) {\n      console.log('[API] getAuthToken error:', err);\n      return null;\n    }\n  };\n\n  // Request interceptor\n  api.interceptors.request.use(config => {\n    // Ensure API key is always present\n    if (config.headers) {\n      config.headers['X-API-Key'] = MEGARADIO_API_KEY;\n\n      // Add mobile auth token if available and not already set\n      var token = getAuthToken();\n      if (token && !config.headers['Authorization']) {\n        config.headers['Authorization'] = `Bearer ${token}`;\n      }\n    }\n    return config;\n  }, error => {\n    return Promise.reject(error);\n  });\n\n  // Response interceptor with retry for 429\n  api.interceptors.response.use(response => {\n    return response;\n  }, /*#__PURE__*/function () {\n    var _ref = (0, _asyncToGenerator.default)(function* (error) {\n      var config = error.config;\n      // Retry on 429 (rate limit) - max 2 retries with delay\n      if (error.response?.status === 429 && (!config._retryCount || config._retryCount < 2)) {\n        config._retryCount = (config._retryCount || 0) + 1;\n        var delay = config._retryCount * 1500; // 1.5s, 3s\n        yield new Promise(r => setTimeout(r, delay));\n        return api(config);\n      }\n      // Handle 401 unauthorized globally\n      if (error.response?.status === 401) {\n        console.log('Unauthorized - session may have expired');\n      }\n      return Promise.reject(error);\n    });\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }());\n  var _default = api;\n});","lineCount":99,"map":[[12,2,80,0,"Object"],[12,8,80,0],[12,9,80,0,"defineProperty"],[12,23,80,0],[12,24,80,0,"exports"],[12,31,80,0],[13,4,80,0,"enumerable"],[13,14,80,0],[14,4,80,0,"get"],[14,7,80,0],[14,18,80,0,"get"],[14,19,80,0],[15,6,80,0],[15,13,80,0,"_default"],[15,21,80,0],[16,4,80,0],[17,2,80,0],[18,2,80,19],[18,6,80,19,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,80,19],[18,45,80,19,"require"],[18,52,80,19],[18,53,80,19,"_dependencyMap"],[18,67,80,19],[19,2,80,19],[19,6,80,19,"_asyncToGenerator"],[19,23,80,19],[19,26,80,19,"_interopDefault"],[19,41,80,19],[19,42,80,19,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,80,19],[20,2,1,0],[20,6,1,0,"_axios"],[20,12,1,0],[20,15,1,0,"require"],[20,22,1,0],[20,23,1,0,"_dependencyMap"],[20,37,1,0],[21,2,1,0],[21,6,1,0,"axios"],[21,11,1,0],[21,14,1,0,"_interopDefault"],[21,29,1,0],[21,30,1,0,"_axios"],[21,36,1,0],[22,2,2,0],[22,6,2,0,"_reactNative"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_constantsApi"],[23,19,3,0],[23,22,3,0,"require"],[23,29,3,0],[23,30,3,0,"_dependencyMap"],[23,44,3,0],[24,2,5,0],[25,2,6,0],[25,6,6,6,"MEGARADIO_API_KEY"],[25,23,6,23],[25,26,6,26],[25,63,6,63],[27,2,8,0],[28,2,9,0],[29,2,10,0],[29,6,10,6,"isWeb"],[29,11,10,11],[29,14,10,14,"Platform"],[29,26,10,22],[29,27,10,22,"Platform"],[29,35,10,22],[29,36,10,23,"OS"],[29,38,10,25],[29,43,10,30],[29,48,10,35],[31,2,12,0],[32,2,13,0],[32,6,13,6,"api"],[32,9,13,24],[32,12,13,27,"axios"],[32,17,13,32],[32,18,13,32,"default"],[32,25,13,32],[32,26,13,33,"create"],[32,32,13,39],[32,33,13,40],[33,4,14,2,"baseURL"],[33,11,14,9],[33,13,14,11,"API_BASE_URL"],[33,26,14,23],[33,27,14,23,"API_BASE_URL"],[33,39,14,23],[34,4,15,2,"timeout"],[34,11,15,9],[34,13,15,11],[34,18,15,16],[35,4,16,2,"headers"],[35,11,16,9],[35,13,16,11],[36,6,17,4],[36,20,17,18],[36,22,17,20],[36,40,17,38],[37,6,18,4],[37,17,18,15],[37,19,18,17,"MEGARADIO_API_KEY"],[38,4,19,2],[38,5,19,3],[39,4,20,2],[40,4,21,2,"withCredentials"],[40,19,21,17],[40,21,21,19],[40,22,21,20,"isWeb"],[41,2,22,0],[41,3,22,1],[41,4,22,2],[43,2,24,0],[44,2,25,0],[44,6,25,6,"getAuthToken"],[44,18,25,18],[44,21,25,21,"getAuthToken"],[44,22,25,21],[44,27,25,42],[45,4,26,2],[45,8,26,6],[46,6,27,4],[47,6,28,4],[47,10,28,4,"_require"],[47,18,28,4],[47,21,28,29,"require"],[47,28,28,36],[47,29,28,36,"_dependencyMap"],[47,43,28,36],[47,68,28,57],[47,69,28,58],[48,8,28,12,"useAuthStore"],[48,20,28,24],[48,23,28,24,"_require"],[48,31,28,24],[48,32,28,12,"useAuthStore"],[48,44,28,24],[49,6,29,4],[49,10,29,10,"token"],[49,15,29,15],[49,18,29,18,"useAuthStore"],[49,30,29,30],[49,31,29,31,"getState"],[49,39,29,39],[49,40,29,40],[49,41,29,41],[49,42,29,42,"token"],[49,47,29,47],[50,6,30,4,"console"],[50,13,30,11],[50,14,30,12,"log"],[50,17,30,15],[50,18,30,16],[50,60,30,58],[50,62,30,60],[50,63,30,61],[50,64,30,62,"token"],[50,69,30,67],[50,71,30,69,"token"],[50,76,30,74],[50,79,30,77,"token"],[50,84,30,82],[50,85,30,83,"substring"],[50,94,30,92],[50,95,30,93],[50,96,30,94],[50,98,30,96],[50,100,30,98],[50,101,30,99],[50,104,30,102],[50,109,30,107],[50,112,30,110],[50,118,30,116],[50,119,30,117],[51,6,31,4],[51,13,31,11,"token"],[51,18,31,16],[52,4,32,2],[52,5,32,3],[52,6,32,4],[52,13,32,11,"err"],[52,16,32,14],[52,18,32,16],[53,6,33,4,"console"],[53,13,33,11],[53,14,33,12,"log"],[53,17,33,15],[53,18,33,16],[53,45,33,43],[53,47,33,45,"err"],[53,50,33,48],[53,51,33,49],[54,6,34,4],[54,13,34,11],[54,17,34,15],[55,4,35,2],[56,2,36,0],[56,3,36,1],[58,2,38,0],[59,2,39,0,"api"],[59,5,39,3],[59,6,39,4,"interceptors"],[59,18,39,16],[59,19,39,17,"request"],[59,26,39,24],[59,27,39,25,"use"],[59,30,39,28],[59,31,40,3,"config"],[59,37,40,37],[59,41,40,42],[60,4,41,4],[61,4,42,4],[61,8,42,8,"config"],[61,14,42,14],[61,15,42,15,"headers"],[61,22,42,22],[61,24,42,24],[62,6,43,6,"config"],[62,12,43,12],[62,13,43,13,"headers"],[62,20,43,20],[62,21,43,21],[62,32,43,32],[62,33,43,33],[62,36,43,36,"MEGARADIO_API_KEY"],[62,53,43,53],[64,6,45,6],[65,6,46,6],[65,10,46,12,"token"],[65,15,46,17],[65,18,46,20,"getAuthToken"],[65,30,46,32],[65,31,46,33],[65,32,46,34],[66,6,47,6],[66,10,47,10,"token"],[66,15,47,15],[66,19,47,19],[66,20,47,20,"config"],[66,26,47,26],[66,27,47,27,"headers"],[66,34,47,34],[66,35,47,35],[66,50,47,50],[66,51,47,51],[66,53,47,53],[67,8,48,8,"config"],[67,14,48,14],[67,15,48,15,"headers"],[67,22,48,22],[67,23,48,23],[67,38,48,38],[67,39,48,39],[67,42,48,42],[67,52,48,52,"token"],[67,57,48,57],[67,59,48,59],[68,6,49,6],[69,4,50,4],[70,4,51,4],[70,11,51,11,"config"],[70,17,51,17],[71,2,52,2],[71,3,52,3],[71,5,53,3,"error"],[71,10,53,8],[71,14,53,13],[72,4,54,4],[72,11,54,11,"Promise"],[72,18,54,18],[72,19,54,19,"reject"],[72,25,54,25],[72,26,54,26,"error"],[72,31,54,31],[72,32,54,32],[73,2,55,2],[73,3,56,0],[73,4,56,1],[75,2,58,0],[76,2,59,0,"api"],[76,5,59,3],[76,6,59,4,"interceptors"],[76,18,59,16],[76,19,59,17,"response"],[76,27,59,25],[76,28,59,26,"use"],[76,31,59,29],[76,32,60,3,"response"],[76,40,60,11],[76,44,60,16],[77,4,61,4],[77,11,61,11,"response"],[77,19,61,19],[78,2,62,2],[78,3,62,3],[79,4,62,3],[79,8,62,3,"_ref"],[79,12,62,3],[79,19,62,3,"_asyncToGenerator"],[79,36,62,3],[79,37,62,3,"default"],[79,44,62,3],[79,46,63,2],[79,57,63,9,"error"],[79,62,63,14],[79,64,63,19],[80,6,64,4],[80,10,64,10,"config"],[80,16,64,16],[80,19,64,19,"error"],[80,24,64,24],[80,25,64,25,"config"],[80,31,64,31],[81,6,65,4],[82,6,66,4],[82,10,66,8,"error"],[82,15,66,13],[82,16,66,14,"response"],[82,24,66,22],[82,26,66,24,"status"],[82,32,66,30],[82,37,66,35],[82,40,66,38],[82,45,66,43],[82,46,66,44,"config"],[82,52,66,50],[82,53,66,51,"_retryCount"],[82,64,66,62],[82,68,66,66,"config"],[82,74,66,72],[82,75,66,73,"_retryCount"],[82,86,66,84],[82,89,66,87],[82,90,66,88],[82,91,66,89],[82,93,66,91],[83,8,67,6,"config"],[83,14,67,12],[83,15,67,13,"_retryCount"],[83,26,67,24],[83,29,67,27],[83,30,67,28,"config"],[83,36,67,34],[83,37,67,35,"_retryCount"],[83,48,67,46],[83,52,67,50],[83,53,67,51],[83,57,67,55],[83,58,67,56],[84,8,68,6],[84,12,68,12,"delay"],[84,17,68,17],[84,20,68,20,"config"],[84,26,68,26],[84,27,68,27,"_retryCount"],[84,38,68,38],[84,41,68,41],[84,45,68,45],[84,46,68,46],[84,47,68,47],[85,8,69,6],[85,14,69,12],[85,18,69,16,"Promise"],[85,25,69,23],[85,26,69,24,"r"],[85,27,69,25],[85,31,69,29,"setTimeout"],[85,41,69,39],[85,42,69,40,"r"],[85,43,69,41],[85,45,69,43,"delay"],[85,50,69,48],[85,51,69,49],[85,52,69,50],[86,8,70,6],[86,15,70,13,"api"],[86,18,70,16],[86,19,70,17,"config"],[86,25,70,23],[86,26,70,24],[87,6,71,4],[88,6,72,4],[89,6,73,4],[89,10,73,8,"error"],[89,15,73,13],[89,16,73,14,"response"],[89,24,73,22],[89,26,73,24,"status"],[89,32,73,30],[89,37,73,35],[89,40,73,38],[89,42,73,40],[90,8,74,6,"console"],[90,15,74,13],[90,16,74,14,"log"],[90,19,74,17],[90,20,74,18],[90,61,74,59],[90,62,74,60],[91,6,75,4],[92,6,76,4],[92,13,76,11,"Promise"],[92,20,76,18],[92,21,76,19,"reject"],[92,27,76,25],[92,28,76,26,"error"],[92,33,76,31],[92,34,76,32],[93,4,77,2],[93,5,77,3],[94,4,77,3],[94,21,77,3,"_x"],[94,23,77,3],[95,6,77,3],[95,13,77,3,"_ref"],[95,17,77,3],[95,18,77,3,"apply"],[95,23,77,3],[95,30,77,3,"arguments"],[95,39,77,3],[96,4,77,3],[97,2,77,3],[97,5,78,0],[97,6,78,1],[98,2,80,0],[98,6,80,0,"_default"],[98,14,80,0],[98,17,80,15,"api"],[98,20,80,18],[99,0,80,19],[99,3]],"functionMap":{"names":["<global>","getAuthToken","interceptors.request.use$argument_0","interceptors.request.use$argument_1","interceptors.response.use$argument_0","interceptors.response.use$argument_1","Promise$argument_0"],"mappings":"AAA;qBCwB;CDW;EEI;GFY;EGC;GHE;EIK;GJE;EKC;wBCM,yBD;GLQ"},"hasCjsExports":false},"type":"js/module"}]}