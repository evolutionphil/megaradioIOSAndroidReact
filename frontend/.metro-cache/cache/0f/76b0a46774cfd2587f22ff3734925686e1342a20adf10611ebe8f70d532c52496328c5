{"dependencies":[{"name":"./encodePacket.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":26,"index":350},"end":{"line":6,"column":54,"index":378}}],"key":"POxAYEaHubdwPacA5GZumZTdi38=","exportNames":["*"],"imports":1}},{"name":"./decodePacket.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":26,"index":537},"end":{"line":8,"column":54,"index":565}}],"key":"0yD+27N9K2+h+6fBL5tV5MSbuvM=","exportNames":["*"],"imports":1}},{"name":"./commons.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":10,"column":21,"index":719},"end":{"line":10,"column":44,"index":742}}],"key":"BsP1rur2s8tExOXn4/1q3+2ZDEY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,_i,a,m,e,d){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.decodePayload=e.decodePacket=e.encodePayload=e.encodePacket=e.protocol=void 0,e.createPacketEncoderStream=function(){return new TransformStream({transform(n,o){(0,t.encodePacketToBinary)(n,t=>{const c=t.length;let i;if(c<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,c);else if(c<65536){i=new Uint8Array(3);const t=new DataView(i.buffer);t.setUint8(0,126),t.setUint16(1,c)}else{i=new Uint8Array(9);const t=new DataView(i.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(c))}n.data&&\"string\"!=typeof n.data&&(i[0]|=128),o.enqueue(i),o.enqueue(t)})}})},e.createPacketDecoderStream=function(t,c){i||(i=new TextDecoder);const u=[];let l=0,P=-1,w=!1;return new TransformStream({transform(b,k){for(u.push(b);;){if(0===l){if(f(u)<1)break;const t=s(u,1);w=!(128&~t[0]),P=127&t[0],l=P<126?3:126===P?1:2}else if(1===l){if(f(u)<2)break;const t=s(u,2);P=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),l=3}else if(2===l){if(f(u)<8)break;const t=s(u,8),n=new DataView(t.buffer,t.byteOffset,t.length),c=n.getUint32(0);if(c>Math.pow(2,21)-1){k.enqueue(o.ERROR_PACKET);break}P=c*Math.pow(2,32)+n.getUint32(4),l=3}else{if(f(u)<P)break;const t=s(u,P);k.enqueue((0,n.decodePacket)(w?t:i.decode(t),c)),l=0}if(0===P||P>t){k.enqueue(o.ERROR_PACKET);break}}}})};const t=r(d[0]);Object.defineProperty(e,\"encodePacket\",{enumerable:!0,get:function(){return t.encodePacket}});const n=r(d[1]);Object.defineProperty(e,\"decodePacket\",{enumerable:!0,get:function(){return n.decodePacket}});const o=r(d[2]),c=String.fromCharCode(30);e.encodePayload=(n,o)=>{const i=n.length,f=new Array(i);let s=0;n.forEach((n,u)=>{(0,t.encodePacket)(n,!1,t=>{f[u]=t,++s===i&&o(f.join(c))})})};let i;function f(t){return t.reduce((t,n)=>t+n.length,0)}function s(t,n){if(t[0].length===n)return t.shift();const o=new Uint8Array(n);let c=0;for(let i=0;i<n;i++)o[i]=t[0][c++],c===t[0].length&&(t.shift(),c=0);return t.length&&c<t[0].length&&(t[0]=t[0].slice(c)),o}e.decodePayload=(t,o)=>{const i=t.split(c),f=[];for(let t=0;t<i.length;t++){const c=(0,n.decodePacket)(i[t],o);if(f.push(c),\"error\"===c.type)break}return f},e.protocol=4});","lineCount":1,"map":[[1,29,1,0],[1,42,2,0,"Object"],[1,49,2,7,"defineProperty"],[1,64,2,22,"exports"],[1,66,2,31],[1,79,2,45],[1,80,2,47,"value"],[1,87,2,54],[1,91,3,0,"exports"],[1,93,3,8,"decodePayload"],[1,107,3,24,"exports"],[1,109,3,32,"decodePacket"],[1,122,3,47,"exports"],[1,124,3,55,"encodePayload"],[1,138,3,71,"exports"],[1,140,3,79,"encodePacket"],[1,153,3,94,"exports"],[1,155,3,102,"protocol"],[1,169,3,110,"undefined"],[1,171,4,0,"exports"],[1,173,4,8,"createPacketEncoderStream"],[1,199,41,0],[1,210,42,4],[1,217,42,11],[1,221,42,15,"TransformStream"],[1,237,42,31],[1,238,43,8,"transform"],[1,248,43,18,"packet"],[1,250,43,26,"controller"],[1,254,44,12],[1,256,44,16,"encodePacket_js_1"],[1,258,44,34,"encodePacketToBinary"],[1,280,44,56,"packet"],[1,282,44,65,"encodedPacket"],[1,286,45,16],[1,292,45,22,"payloadLength"],[1,294,45,38,"encodedPacket"],[1,296,45,52,"length"],[1,303,46,16],[1,307,46,20,"header"],[1,309,48,16],[1,312,48,20,"payloadLength"],[1,314,48,36],[1,318,49,20,"header"],[1,320,49,29],[1,324,49,33,"Uint8Array"],[1,335,49,44],[1,338,50,20],[1,342,50,24,"DataView"],[1,351,50,33,"header"],[1,353,50,40,"buffer"],[1,361,50,48,"setUint8"],[1,370,50,57],[1,372,50,60,"payloadLength"],[1,380,52,21],[1,383,52,25,"payloadLength"],[1,385,52,41],[1,391,52,48],[1,392,53,20,"header"],[1,394,53,29],[1,398,53,33,"Uint8Array"],[1,409,53,44],[1,412,54,20],[1,418,54,26,"view"],[1,420,54,33],[1,424,54,37,"DataView"],[1,433,54,46,"header"],[1,435,54,53,"buffer"],[1,443,55,20,"view"],[1,445,55,25,"setUint8"],[1,454,55,34],[1,456,55,37],[1,461,56,20,"view"],[1,463,56,25,"setUint16"],[1,473,56,35],[1,475,56,38,"payloadLength"],[1,477,57,16],[1,482,58,21],[1,483,59,20,"header"],[1,485,59,29],[1,489,59,33,"Uint8Array"],[1,500,59,44],[1,503,60,20],[1,509,60,26,"view"],[1,511,60,33],[1,515,60,37,"DataView"],[1,524,60,46,"header"],[1,526,60,53,"buffer"],[1,534,61,20,"view"],[1,536,61,25,"setUint8"],[1,545,61,34],[1,547,61,37],[1,552,62,20,"view"],[1,554,62,25,"setBigUint64"],[1,567,62,38],[1,569,62,41,"BigInt"],[1,576,62,48,"payloadLength"],[1,579,63,16],[1,580,65,20,"packet"],[1,582,65,27,"data"],[1,588,65,58],[1,605,65,42,"packet"],[1,607,65,49,"data"],[1,614,66,20,"header"],[1,616,66,27],[1,620,66,33],[1,625,68,16,"controller"],[1,627,68,27,"enqueue"],[1,635,68,35,"header"],[1,638,69,16,"controller"],[1,640,69,27,"enqueue"],[1,648,69,35,"encodedPacket"],[1,652,71,8],[1,655,73,0],[1,657,5,0,"exports"],[1,659,5,8,"createPacketDecoderStream"],[1,685,96,0],[1,694,96,35,"maxPayload"],[1,696,96,47,"binaryType"],[1,699,97,9,"TEXT_DECODER"],[1,703,98,8,"TEXT_DECODER"],[1,705,98,23],[1,709,98,27,"TextDecoder"],[1,722,100,4],[1,728,100,10,"chunks"],[1,730,100,19],[1,733,101,4],[1,737,101,8,"state"],[1,739,101,16],[1,741,102,8,"expectedLength"],[1,744,102,22],[1,746,103,8,"isBinary"],[1,749,103,19],[1,751,104,4],[1,758,104,11],[1,762,104,15,"TransformStream"],[1,778,104,31],[1,779,105,8,"transform"],[1,789,105,18,"chunk"],[1,791,105,25,"controller"],[1,794,107,12],[1,798,106,12,"chunks"],[1,800,106,19,"push"],[1,805,106,24,"chunk"],[1,810,107,25],[1,811,108,16],[1,814,108,30],[1,818,108,20,"state"],[1,820,108,57],[1,821,109,20],[1,824,109,24,"totalLength"],[1,826,109,36,"chunks"],[1,829,109,46],[1,831,110,24],[1,837,112,20],[1,843,112,26,"header"],[1,845,112,35,"concatChunks"],[1,847,112,48,"chunks"],[1,849,112,56],[1,852,113,20,"isBinary"],[1,856,113,54],[1,861,113,32,"header"],[1,863,113,39],[1,867,114,20,"expectedLength"],[1,869,114,49],[1,873,114,37,"header"],[1,875,114,44],[1,878,116,24,"state"],[1,880,115,24,"expectedLength"],[1,882,115,41],[1,886,116,32],[1,888,118,48],[1,894,118,29,"expectedLength"],[1,896,119,32],[1,898,122,32],[1,899,124,16],[1,905,125,21],[1,908,125,35],[1,912,125,25,"state"],[1,914,125,74],[1,915,126,20],[1,918,126,24,"totalLength"],[1,920,126,36,"chunks"],[1,923,126,46],[1,925,127,24],[1,931,129,20],[1,937,129,26,"headerArray"],[1,939,129,40,"concatChunks"],[1,941,129,53,"chunks"],[1,943,129,61],[1,946,130,20,"expectedLength"],[1,948,130,37],[1,952,130,41,"DataView"],[1,961,130,50,"headerArray"],[1,963,130,62,"buffer"],[1,970,130,70,"headerArray"],[1,972,130,82,"byteOffset"],[1,983,130,94,"headerArray"],[1,985,130,106,"length"],[1,993,130,114,"getUint16"],[1,1003,130,124],[1,1006,131,20,"state"],[1,1008,131,28],[1,1009,132,16],[1,1015,133,21],[1,1018,133,35],[1,1022,133,25,"state"],[1,1024,133,74],[1,1025,134,20],[1,1028,134,24,"totalLength"],[1,1030,134,36,"chunks"],[1,1033,134,46],[1,1035,135,24],[1,1041,137,20],[1,1047,137,26,"headerArray"],[1,1049,137,40,"concatChunks"],[1,1051,137,53,"chunks"],[1,1053,137,61],[1,1056,138,26,"view"],[1,1058,138,33],[1,1062,138,37,"DataView"],[1,1071,138,46,"headerArray"],[1,1073,138,58,"buffer"],[1,1080,138,66,"headerArray"],[1,1082,138,78,"byteOffset"],[1,1093,138,90,"headerArray"],[1,1095,138,102,"length"],[1,1103,139,26,"n"],[1,1105,139,30,"view"],[1,1107,139,35,"getUint32"],[1,1117,139,45],[1,1120,140,20],[1,1123,140,24,"n"],[1,1125,140,28,"Math"],[1,1130,140,33,"pow"],[1,1134,140,37],[1,1136,140,38],[1,1140,140,51],[1,1142,140,54],[1,1143,142,24,"controller"],[1,1145,142,35,"enqueue"],[1,1153,142,43,"commons_js_1"],[1,1155,142,56,"ERROR_PACKET"],[1,1169,143,24],[1,1174,144,20],[1,1175,145,20,"expectedLength"],[1,1177,145,37,"n"],[1,1179,145,41,"Math"],[1,1184,145,46,"pow"],[1,1188,145,50],[1,1190,145,53],[1,1194,145,59,"view"],[1,1196,145,64,"getUint32"],[1,1206,145,74],[1,1209,146,20,"state"],[1,1211,146,28],[1,1212,147,16],[1,1217,148,21],[1,1218,149,20],[1,1221,149,24,"totalLength"],[1,1223,149,36,"chunks"],[1,1226,149,46,"expectedLength"],[1,1228,150,24],[1,1234,152,20],[1,1240,152,26,"data"],[1,1242,152,33,"concatChunks"],[1,1244,152,46,"chunks"],[1,1246,152,54,"expectedLength"],[1,1249,153,20,"controller"],[1,1251,153,31,"enqueue"],[1,1260,153,39],[1,1262,153,43,"decodePacket_js_1"],[1,1264,153,61,"decodePacket"],[1,1278,153,75,"isBinary"],[1,1280,153,86,"data"],[1,1282,153,93,"TEXT_DECODER"],[1,1284,153,106,"decode"],[1,1291,153,113,"data"],[1,1294,153,120,"binaryType"],[1,1298,154,20,"state"],[1,1300,154,28],[1,1301,155,16],[1,1302,156,16],[1,1305,156,39],[1,1309,156,20,"expectedLength"],[1,1312,156,44,"expectedLength"],[1,1314,156,61,"maxPayload"],[1,1316,156,73],[1,1317,157,20,"controller"],[1,1319,157,31,"enqueue"],[1,1327,157,39,"commons_js_1"],[1,1329,157,52,"ERROR_PACKET"],[1,1343,158,20],[1,1348,159,16],[1,1349,160,12],[1,1350,161,8],[1,1353,163,0],[1,1355,6,0],[1,1361,6,6,"encodePacket_js_1"],[1,1363,6,26,"require"],[1,1365,6,33,"d"],[1,1367,6,33],[1,1371,7,0,"Object"],[1,1378,7,7,"defineProperty"],[1,1393,7,22,"exports"],[1,1395,7,31],[1,1410,7,47],[1,1411,7,49,"enumerable"],[1,1423,7,61],[1,1425,7,67,"get"],[1,1429,7,72],[1,1440,7,86],[1,1447,7,93,"encodePacket_js_1"],[1,1449,7,111,"encodePacket"],[1,1461,7,125],[1,1465,8,0],[1,1471,8,6,"decodePacket_js_1"],[1,1473,8,26,"require"],[1,1475,8,33,"d"],[1,1477,8,33],[1,1481,9,0,"Object"],[1,1488,9,7,"defineProperty"],[1,1503,9,22,"exports"],[1,1505,9,31],[1,1520,9,47],[1,1521,9,49,"enumerable"],[1,1533,9,61],[1,1535,9,67,"get"],[1,1539,9,72],[1,1550,9,86],[1,1557,9,93,"decodePacket_js_1"],[1,1559,9,111,"decodePacket"],[1,1571,9,125],[1,1575,10,0],[1,1581,10,6,"commons_js_1"],[1,1583,10,21,"require"],[1,1585,10,28,"d"],[1,1587,10,28],[1,1591,11,6,"SEPARATOR"],[1,1593,11,18,"String"],[1,1600,11,25,"fromCharCode"],[1,1613,11,38],[1,1617,27,0,"exports"],[1,1619,27,8,"encodePayload"],[1,1633,12,22,"encodePayload"],[1,1634,12,23,"packets"],[1,1636,12,32,"callback"],[1,1641,14,4],[1,1647,14,10,"length"],[1,1649,14,19,"packets"],[1,1651,14,27,"length"],[1,1658,15,10,"encodedPackets"],[1,1660,15,27],[1,1664,15,31,"Array"],[1,1670,15,37,"length"],[1,1673,16,4],[1,1677,16,8,"count"],[1,1679,16,16],[1,1681,17,4,"packets"],[1,1683,17,12,"forEach"],[1,1691,17,20],[1,1692,17,21,"packet"],[1,1694,17,29,"i"],[1,1700,19,8],[1,1702,19,12,"encodePacket_js_1"],[1,1704,19,30,"encodePacket"],[1,1718,19,44,"packet"],[1,1721,19,52],[1,1723,19,60,"encodedPacket"],[1,1727,20,12,"encodedPackets"],[1,1729,20,27,"i"],[1,1732,20,32,"encodedPacket"],[1,1736,21,18,"count"],[1,1740,21,28,"length"],[1,1743,22,16,"callback"],[1,1745,22,25,"encodedPackets"],[1,1747,22,40,"join"],[1,1752,22,45,"SEPARATOR"],[1,1761,74,0],[1,1765,74,4,"TEXT_DECODER"],[1,1767,75,0],[1,1776,75,9,"totalLength"],[1,1778,75,21,"chunks"],[1,1781,76,4],[1,1788,76,11,"chunks"],[1,1790,76,18,"reduce"],[1,1797,76,25],[1,1798,76,26,"acc"],[1,1800,76,31,"chunk"],[1,1804,76,41,"acc"],[1,1806,76,47,"chunk"],[1,1808,76,53,"length"],[1,1815,76,61],[1,1817,77,0],[1,1818,78,0],[1,1827,78,9,"concatChunks"],[1,1829,78,22,"chunks"],[1,1831,78,30,"size"],[1,1834,79,4],[1,1837,79,8,"chunks"],[1,1839,79,15],[1,1842,79,18,"length"],[1,1851,79,29,"size"],[1,1853,80,8],[1,1860,80,15,"chunks"],[1,1862,80,22,"shift"],[1,1870,82,4],[1,1876,82,10,"buffer"],[1,1878,82,19],[1,1882,82,23,"Uint8Array"],[1,1893,82,34,"size"],[1,1896,83,4],[1,1900,83,8,"j"],[1,1902,83,12],[1,1904,84,4],[1,1908,84,9],[1,1912,84,13,"i"],[1,1914,84,17],[1,1916,84,20,"i"],[1,1918,84,24,"size"],[1,1920,84,30,"i"],[1,1924,85,8,"buffer"],[1,1926,85,15,"i"],[1,1929,85,20,"chunks"],[1,1931,85,27],[1,1934,85,30,"j"],[1,1939,86,12,"j"],[1,1943,86,18,"chunks"],[1,1945,86,25],[1,1948,86,28,"length"],[1,1957,87,12,"chunks"],[1,1959,87,19,"shift"],[1,1967,88,12,"j"],[1,1969,88,16],[1,1972,94,4],[1,1979,91,8,"chunks"],[1,1981,91,15,"length"],[1,1989,91,25,"j"],[1,1991,91,29,"chunks"],[1,1993,91,36],[1,1996,91,39,"length"],[1,2005,92,8,"chunks"],[1,2007,92,15],[1,2010,92,20,"chunks"],[1,2012,92,27],[1,2015,92,30,"slice"],[1,2021,92,36,"j"],[1,2025,94,11,"buffer"],[1,2026,95,0],[1,2027,40,0,"exports"],[1,2029,40,8,"decodePayload"],[1,2043,28,22,"decodePayload"],[1,2044,28,23,"encodedPayload"],[1,2046,28,39,"binaryType"],[1,2051,29,4],[1,2057,29,10,"encodedPackets"],[1,2059,29,27,"encodedPayload"],[1,2061,29,42,"split"],[1,2067,29,48,"SEPARATOR"],[1,2070,30,10,"packets"],[1,2072,30,20],[1,2075,31,4],[1,2079,31,9],[1,2083,31,13,"i"],[1,2085,31,17],[1,2087,31,20,"i"],[1,2089,31,24,"encodedPackets"],[1,2091,31,39,"length"],[1,2098,31,47,"i"],[1,2102,31,52],[1,2103,32,8],[1,2109,32,14,"decodedPacket"],[1,2112,32,30],[1,2114,32,34,"decodePacket_js_1"],[1,2116,32,52,"decodePacket"],[1,2130,32,66,"encodedPackets"],[1,2132,32,81,"i"],[1,2135,32,85,"binaryType"],[1,2138,34,8],[1,2141,33,8,"packets"],[1,2143,33,16,"push"],[1,2148,33,21,"decodedPacket"],[1,2151,34,35],[1,2161,34,12,"decodedPacket"],[1,2163,34,26,"type"],[1,2168,35,12],[1,2173,37,4],[1,2174,38,4],[1,2181,38,11,"packets"],[1,2184,164,0,"exports"],[1,2186,164,8,"protocol"],[1,2195,164,19],[1,2196,164,21],[1,2199]],"functionMap":{"names":["<global>","Object.defineProperty$argument_2.get","encodePayload","packets.forEach$argument_0","<anonymous>","decodePayload","createPacketEncoderStream","TransformStream$argument_0.transform","totalLength","chunks.reduce$argument_0","concatChunks","createPacketDecoderStream"],"mappings":"AAA;wECM,sDD;wECE,sDD;sBEG;oBCK;2DCE;SDK;KDC;CFC;sBKE;CLW;AME;QCE;gEHC;aG0B;SDC;CNE;AQE;yBCC,kCD;CRC;AUC;CViB;AWC;QJS;SIwD;CXE"},"hasCjsExports":true},"type":"js/module"}]}