{"dependencies":[{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":73,"index":73}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"../constants/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":115},"end":{"line":3,"column":48,"index":163}}],"key":"ZV0ujAFjHVGmM4aJSYIlDaiTRjE=","exportNames":["*"],"imports":1}},{"name":"../store/authStore","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":28,"column":29,"index":990},"end":{"line":28,"column":58,"index":1019}}],"key":"x4jghCEnTqsoIMgJBq6IvUNyemw=","exportNames":["*"],"imports":1,"isOptional":true}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _axios = require(_dependencyMap[0], \"axios\");\n  var axios = _interopDefault(_axios);\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[1], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _constantsApi = require(_dependencyMap[2], \"../constants/api\");\n  // MegaRadio Internal API Key - unlimited, no rate limiting\n  const MEGARADIO_API_KEY = 'mr_VUzdIUHuXaagvWUC208Vzi_3lqEV1Vzw';\n\n  // For web preview, we cannot use credentials due to CORS\n  // Native apps will handle cookies differently\n  const isWeb = Platform.default.OS === 'web';\n\n  // Create axios instance with API key and cookie support\n  const api = axios.default.create({\n    baseURL: _constantsApi.API_BASE_URL,\n    timeout: 15000,\n    headers: {\n      'Content-Type': 'application/json',\n      'X-API-Key': MEGARADIO_API_KEY\n    },\n    // Only use credentials on native platforms where CORS isn't an issue\n    withCredentials: !isWeb\n  });\n\n  // Helper to get auth token (lazy import to avoid circular dependency)\n  const getAuthToken = () => {\n    try {\n      // Dynamic import of authStore to avoid circular dependency\n      const {\n        useAuthStore\n      } = require(_dependencyMap[3], \"../store/authStore\");\n      const token = useAuthStore.getState().token;\n      return token;\n    } catch (err) {\n      return null;\n    }\n  };\n\n  // Request interceptor - Add tv=1 param to ALL requests for optimized responses\n  // This reduces response size by ~85% (18KB -> 2.5KB per station)\n  api.interceptors.request.use(config => {\n    // Ensure API key is always present\n    if (config.headers) {\n      config.headers['X-API-Key'] = MEGARADIO_API_KEY;\n\n      // Add mobile auth token if available and not already set\n      const token = getAuthToken();\n      if (token && !config.headers['Authorization']) {\n        config.headers['Authorization'] = `Bearer ${token}`;\n      }\n    }\n\n    // Add tv=1 parameter to ALL requests for optimized mobile/TV responses\n    // This returns only essential fields (name, slug, url, favicon, country, votes etc.)\n    config.params = {\n      ...config.params,\n      tv: 1\n    };\n    return config;\n  }, error => {\n    return Promise.reject(error);\n  });\n\n  // Response interceptor with retry for 429\n  api.interceptors.response.use(response => {\n    return response;\n  }, async error => {\n    const config = error.config;\n    // Retry on 429 (rate limit) - max 2 retries with delay\n    if (error.response?.status === 429 && (!config._retryCount || config._retryCount < 2)) {\n      config._retryCount = (config._retryCount || 0) + 1;\n      const delay = config._retryCount * 1500; // 1.5s, 3s\n      await new Promise(r => setTimeout(r, delay));\n      return api(config);\n    }\n    // Handle 401 unauthorized globally\n    if (error.response?.status === 401) {\n      console.log('Unauthorized - session may have expired');\n    }\n    return Promise.reject(error);\n  });\n  var _default = api;\n});","lineCount":100,"map":[[12,2,84,0,"Object"],[12,8,84,0],[12,9,84,0,"defineProperty"],[12,23,84,0],[12,24,84,0,"exports"],[12,31,84,0],[13,4,84,0,"enumerable"],[13,14,84,0],[14,4,84,0,"get"],[14,7,84,0],[14,18,84,0,"get"],[14,19,84,0],[15,6,84,0],[15,13,84,0,"_default"],[15,21,84,0],[16,4,84,0],[17,2,84,0],[18,2,1,0],[18,6,1,0,"_axios"],[18,12,1,0],[18,15,1,0,"require"],[18,22,1,0],[18,23,1,0,"_dependencyMap"],[18,37,1,0],[19,2,1,0],[19,6,1,0,"axios"],[19,11,1,0],[19,14,1,0,"_interopDefault"],[19,29,1,0],[19,30,1,0,"_axios"],[19,36,1,0],[20,2,1,73],[20,6,1,73,"_reactNativeWebDistExportsPlatform"],[20,40,1,73],[20,43,1,73,"require"],[20,50,1,73],[20,51,1,73,"_dependencyMap"],[20,65,1,73],[21,2,1,73],[21,6,1,73,"Platform"],[21,14,1,73],[21,17,1,73,"_interopDefault"],[21,32,1,73],[21,33,1,73,"_reactNativeWebDistExportsPlatform"],[21,67,1,73],[22,2,3,0],[22,6,3,0,"_constantsApi"],[22,19,3,0],[22,22,3,0,"require"],[22,29,3,0],[22,30,3,0,"_dependencyMap"],[22,44,3,0],[23,2,5,0],[24,2,6,0],[24,8,6,6,"MEGARADIO_API_KEY"],[24,25,6,23],[24,28,6,26],[24,65,6,63],[26,2,8,0],[27,2,9,0],[28,2,10,0],[28,8,10,6,"isWeb"],[28,13,10,11],[28,16,10,14,"Platform"],[28,24,10,22],[28,25,10,22,"default"],[28,32,10,22],[28,33,10,23,"OS"],[28,35,10,25],[28,40,10,30],[28,45,10,35],[30,2,12,0],[31,2,13,0],[31,8,13,6,"api"],[31,11,13,24],[31,14,13,27,"axios"],[31,19,13,32],[31,20,13,32,"default"],[31,27,13,32],[31,28,13,33,"create"],[31,34,13,39],[31,35,13,40],[32,4,14,2,"baseURL"],[32,11,14,9],[32,13,14,11,"API_BASE_URL"],[32,26,14,23],[32,27,14,23,"API_BASE_URL"],[32,39,14,23],[33,4,15,2,"timeout"],[33,11,15,9],[33,13,15,11],[33,18,15,16],[34,4,16,2,"headers"],[34,11,16,9],[34,13,16,11],[35,6,17,4],[35,20,17,18],[35,22,17,20],[35,40,17,38],[36,6,18,4],[36,17,18,15],[36,19,18,17,"MEGARADIO_API_KEY"],[37,4,19,2],[37,5,19,3],[38,4,20,2],[39,4,21,2,"withCredentials"],[39,19,21,17],[39,21,21,19],[39,22,21,20,"isWeb"],[40,2,22,0],[40,3,22,1],[40,4,22,2],[42,2,24,0],[43,2,25,0],[43,8,25,6,"getAuthToken"],[43,20,25,18],[43,23,25,21,"getAuthToken"],[43,24,25,21],[43,29,25,42],[44,4,26,2],[44,8,26,6],[45,6,27,4],[46,6,28,4],[46,12,28,10],[47,8,28,12,"useAuthStore"],[48,6,28,25],[48,7,28,26],[48,10,28,29,"require"],[48,17,28,36],[48,18,28,36,"_dependencyMap"],[48,32,28,36],[48,57,28,57],[48,58,28,58],[49,6,29,4],[49,12,29,10,"token"],[49,17,29,15],[49,20,29,18,"useAuthStore"],[49,32,29,30],[49,33,29,31,"getState"],[49,41,29,39],[49,42,29,40],[49,43,29,41],[49,44,29,42,"token"],[49,49,29,47],[50,6,30,4],[50,13,30,11,"token"],[50,18,30,16],[51,4,31,2],[51,5,31,3],[51,6,31,4],[51,13,31,11,"err"],[51,16,31,14],[51,18,31,16],[52,6,32,4],[52,13,32,11],[52,17,32,15],[53,4,33,2],[54,2,34,0],[54,3,34,1],[56,2,36,0],[57,2,37,0],[58,2,38,0,"api"],[58,5,38,3],[58,6,38,4,"interceptors"],[58,18,38,16],[58,19,38,17,"request"],[58,26,38,24],[58,27,38,25,"use"],[58,30,38,28],[58,31,39,3,"config"],[58,37,39,37],[58,41,39,42],[59,4,40,4],[60,4,41,4],[60,8,41,8,"config"],[60,14,41,14],[60,15,41,15,"headers"],[60,22,41,22],[60,24,41,24],[61,6,42,6,"config"],[61,12,42,12],[61,13,42,13,"headers"],[61,20,42,20],[61,21,42,21],[61,32,42,32],[61,33,42,33],[61,36,42,36,"MEGARADIO_API_KEY"],[61,53,42,53],[63,6,44,6],[64,6,45,6],[64,12,45,12,"token"],[64,17,45,17],[64,20,45,20,"getAuthToken"],[64,32,45,32],[64,33,45,33],[64,34,45,34],[65,6,46,6],[65,10,46,10,"token"],[65,15,46,15],[65,19,46,19],[65,20,46,20,"config"],[65,26,46,26],[65,27,46,27,"headers"],[65,34,46,34],[65,35,46,35],[65,50,46,50],[65,51,46,51],[65,53,46,53],[66,8,47,8,"config"],[66,14,47,14],[66,15,47,15,"headers"],[66,22,47,22],[66,23,47,23],[66,38,47,38],[66,39,47,39],[66,42,47,42],[66,52,47,52,"token"],[66,57,47,57],[66,59,47,59],[67,6,48,6],[68,4,49,4],[70,4,51,4],[71,4,52,4],[72,4,53,4,"config"],[72,10,53,10],[72,11,53,11,"params"],[72,17,53,17],[72,20,53,20],[73,6,53,22],[73,9,53,25,"config"],[73,15,53,31],[73,16,53,32,"params"],[73,22,53,38],[74,6,53,40,"tv"],[74,8,53,42],[74,10,53,44],[75,4,53,46],[75,5,53,47],[76,4,55,4],[76,11,55,11,"config"],[76,17,55,17],[77,2,56,2],[77,3,56,3],[77,5,57,3,"error"],[77,10,57,8],[77,14,57,13],[78,4,58,4],[78,11,58,11,"Promise"],[78,18,58,18],[78,19,58,19,"reject"],[78,25,58,25],[78,26,58,26,"error"],[78,31,58,31],[78,32,58,32],[79,2,59,2],[79,3,60,0],[79,4,60,1],[81,2,62,0],[82,2,63,0,"api"],[82,5,63,3],[82,6,63,4,"interceptors"],[82,18,63,16],[82,19,63,17,"response"],[82,27,63,25],[82,28,63,26,"use"],[82,31,63,29],[82,32,64,3,"response"],[82,40,64,11],[82,44,64,16],[83,4,65,4],[83,11,65,11,"response"],[83,19,65,19],[84,2,66,2],[84,3,66,3],[84,5,67,2],[84,11,67,9,"error"],[84,16,67,14],[84,20,67,19],[85,4,68,4],[85,10,68,10,"config"],[85,16,68,16],[85,19,68,19,"error"],[85,24,68,24],[85,25,68,25,"config"],[85,31,68,31],[86,4,69,4],[87,4,70,4],[87,8,70,8,"error"],[87,13,70,13],[87,14,70,14,"response"],[87,22,70,22],[87,24,70,24,"status"],[87,30,70,30],[87,35,70,35],[87,38,70,38],[87,43,70,43],[87,44,70,44,"config"],[87,50,70,50],[87,51,70,51,"_retryCount"],[87,62,70,62],[87,66,70,66,"config"],[87,72,70,72],[87,73,70,73,"_retryCount"],[87,84,70,84],[87,87,70,87],[87,88,70,88],[87,89,70,89],[87,91,70,91],[88,6,71,6,"config"],[88,12,71,12],[88,13,71,13,"_retryCount"],[88,24,71,24],[88,27,71,27],[88,28,71,28,"config"],[88,34,71,34],[88,35,71,35,"_retryCount"],[88,46,71,46],[88,50,71,50],[88,51,71,51],[88,55,71,55],[88,56,71,56],[89,6,72,6],[89,12,72,12,"delay"],[89,17,72,17],[89,20,72,20,"config"],[89,26,72,26],[89,27,72,27,"_retryCount"],[89,38,72,38],[89,41,72,41],[89,45,72,45],[89,46,72,46],[89,47,72,47],[90,6,73,6],[90,12,73,12],[90,16,73,16,"Promise"],[90,23,73,23],[90,24,73,24,"r"],[90,25,73,25],[90,29,73,29,"setTimeout"],[90,39,73,39],[90,40,73,40,"r"],[90,41,73,41],[90,43,73,43,"delay"],[90,48,73,48],[90,49,73,49],[90,50,73,50],[91,6,74,6],[91,13,74,13,"api"],[91,16,74,16],[91,17,74,17,"config"],[91,23,74,23],[91,24,74,24],[92,4,75,4],[93,4,76,4],[94,4,77,4],[94,8,77,8,"error"],[94,13,77,13],[94,14,77,14,"response"],[94,22,77,22],[94,24,77,24,"status"],[94,30,77,30],[94,35,77,35],[94,38,77,38],[94,40,77,40],[95,6,78,6,"console"],[95,13,78,13],[95,14,78,14,"log"],[95,17,78,17],[95,18,78,18],[95,59,78,59],[95,60,78,60],[96,4,79,4],[97,4,80,4],[97,11,80,11,"Promise"],[97,18,80,18],[97,19,80,19,"reject"],[97,25,80,25],[97,26,80,26,"error"],[97,31,80,31],[97,32,80,32],[98,2,81,2],[98,3,82,0],[98,4,82,1],[99,2,84,0],[99,6,84,0,"_default"],[99,14,84,0],[99,17,84,15,"api"],[99,20,84,18],[100,0,84,19],[100,3]],"functionMap":{"names":["<global>","getAuthToken","interceptors.request.use$argument_0","interceptors.request.use$argument_1","interceptors.response.use$argument_0","interceptors.response.use$argument_1","Promise$argument_0"],"mappings":"AAA;qBCwB;CDS;EEK;GFiB;EGC;GHE;EIK;GJE;EKC;wBCM,yBD;GLQ"},"hasCjsExports":false},"type":"js/module"}]}