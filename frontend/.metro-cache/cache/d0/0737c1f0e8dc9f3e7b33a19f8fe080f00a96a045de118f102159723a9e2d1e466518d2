{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":69,"index":103}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"./authStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":104},"end":{"line":3,"column":43,"index":147}}],"key":"U6CTK4XdRNkRchTKeKtDOo47dKY=","exportNames":["*"],"imports":1}},{"name":"../services/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":148},"end":{"line":4,"column":34,"index":182}}],"key":"Pr5/EB33W7mJGi+ygccy+pUf1E8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,d){\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"default\",{enumerable:!0,get:function(){return u}}),Object.defineProperty(_e,\"useRecentlyPlayedStore\",{enumerable:!0,get:function(){return y}});var t=r(d[0]),o=e(r(d[1])),n=r(d[2]),l=e(r(d[3]));const s='megaradio_recently_played',c=()=>n.useAuthStore.getState().isAuthenticated,y=(0,t.create)((e,t)=>({stations:[],loaded:!1,isLoading:!1,addStation:n=>{const l=t().stations.filter(e=>e._id!==n._id),y=[n,...l].slice(0,12);e({stations:y}),o.default.setItem(s,JSON.stringify(y)).catch(()=>{}),c()&&t().syncToAPI(n._id)},loadFromStorage:async()=>{if(!t().loaded)try{const t=await o.default.getItem(s);e(t?{stations:JSON.parse(t),loaded:!0}:{loaded:!0})}catch{e({loaded:!0})}},loadFromAPI:async()=>{if(!c())return console.log('[RecentlyPlayedStore] Not authenticated, loading from local storage'),void await t().loadFromStorage();e({isLoading:!0});try{console.log('[RecentlyPlayedStore] Loading from API with auth token...');const t=(await l.default.get('/api/recently-played')).data;let n=Array.isArray(t)?t:t.stations||[];const c=new Set;n=n.filter(e=>c.has(e._id)?(console.log('[RecentlyPlayedStore] Removing duplicate station:',e._id),!1):(c.add(e._id),!0)),console.log('[RecentlyPlayedStore] API returned',n.length,'unique stations');const y=await o.default.getItem(s),u=y?JSON.parse(y):[],S=new Set(n.map(e=>e._id)),f=u.filter(e=>!S.has(e._id)),P=[...n,...f].slice(0,12);e({stations:P,loaded:!0,isLoading:!1}),await o.default.setItem(s,JSON.stringify(P))}catch(o){console.error('[RecentlyPlayedStore] Error loading from API:',o),await t().loadFromStorage(),e({isLoading:!1})}},syncToAPI:async e=>{if(c())try{console.log('[RecentlyPlayedStore] Syncing station to API:',e),await l.default.post('/api/recently-played',{stationId:e}),console.log('[RecentlyPlayedStore] Successfully synced to API')}catch(e){console.error('[RecentlyPlayedStore] Error syncing to API:',e)}else console.log('[RecentlyPlayedStore] Not authenticated, skipping API sync')}}));n.useAuthStore.subscribe((e,t)=>{e.isAuthenticated!==t.isAuthenticated&&(console.log('[RecentlyPlayedStore] Auth status changed, reloading...'),y.setState({loaded:!1}),y.getState().loadFromAPI())});var u=y});","lineCount":1,"map":[[1,143,144,0,"Object"],[1,150,144,0,"defineProperty"],[1,165,144,0,"_e"],[1,168,144,0],[1,179,144,0,"enumerable"],[1,191,144,0],[1,193,144,0,"get"],[1,197,144,0],[1,215,144,0,"_default"],[1,216,144,0],[1,220,25,0,"Object"],[1,227,25,0,"defineProperty"],[1,242,25,0,"_e"],[1,245,25,0],[1,271,25,0,"enumerable"],[1,283,25,0],[1,285,25,0,"get"],[1,289,25,0],[1,307,25,0,"useRecentlyPlayedStore"],[1,308,25,0],[1,312,1,0],[1,316,1,0,"_zustand"],[1,318,1,0,"r"],[1,320,1,0,"d"],[1,322,1,0],[1,326,2,0,"AsyncStorage"],[1,328,2,0,"_interopDefault"],[1,330,2,0,"r"],[1,332,2,0,"d"],[1,334,2,0],[1,339,3,0,"_authStore"],[1,341,3,0,"r"],[1,343,3,0,"d"],[1,345,3,0],[1,349,4,0,"api"],[1,351,4,0,"_interopDefault"],[1,353,4,0,"r"],[1,355,4,0,"d"],[1,357,4,0],[1,362,7,0],[1,368,7,6,"STORAGE_KEY"],[1,370,7,20],[1,398,21,6,"isAuthenticated"],[1,400,21,24,"isAuthenticated"],[1,404,22,9,"useAuthStore"],[1,406,22,21,"useAuthStore"],[1,419,22,22,"getState"],[1,430,22,33,"isAuthenticated"],[1,446,25,13,"useRecentlyPlayedStore"],[1,449,25,38],[1,451,25,38,"create"],[1,453,25,44,"create"],[1,461,25,66],[1,462,25,67,"set"],[1,464,25,72,"get"],[1,469,25,75],[1,470,26,2,"stations"],[1,479,26,12],[1,482,27,2,"loaded"],[1,490,27,10],[1,492,28,2,"isLoading"],[1,503,28,13],[1,505,30,2,"addStation"],[1,516,30,15,"station"],[1,520,31,4],[1,526,33,10,"filtered"],[1,528,31,20,"get"],[1,532,31,26,"stations"],[1,541,33,29,"filter"],[1,548,33,36,"s"],[1,551,33,41,"s"],[1,553,33,43,"_id"],[1,559,33,51,"station"],[1,561,33,59,"_id"],[1,566,34,10,"updated"],[1,568,34,20],[1,569,34,21,"station"],[1,574,34,33,"filtered"],[1,577,34,43,"slice"],[1,583,34,49],[1,585,8,19],[1,589,35,4,"set"],[1,591,35,8],[1,592,35,10,"stations"],[1,601,35,20,"updated"],[1,605,38,4,"AsyncStorage"],[1,607,38,16,"default"],[1,615,38,17,"setItem"],[1,623,38,25,"STORAGE_KEY"],[1,625,38,38,"JSON"],[1,630,38,43,"stringify"],[1,640,38,53,"updated"],[1,644,38,63,"catch"],[1,650,38,69],[1,658,41,8,"isAuthenticated"],[1,663,42,6,"get"],[1,667,42,12,"syncToAPI"],[1,677,42,22,"station"],[1,679,42,30,"_id"],[1,685,46,2,"loadFromStorage"],[1,701,46,19,"async"],[1,711,47,4],[1,715,47,8,"get"],[1,719,47,14,"loaded"],[1,726,48,4],[1,730,49,6],[1,736,49,12,"data"],[1,744,49,25,"AsyncStorage"],[1,746,49,37,"default"],[1,754,49,38,"getItem"],[1,762,49,46,"STORAGE_KEY"],[1,765,51,8,"set"],[1,767,50,10,"data"],[1,769,51,12],[1,770,51,14,"stations"],[1,779,51,24,"JSON"],[1,784,51,29,"parse"],[1,790,51,35,"data"],[1,793,51,42,"loaded"],[1,801,51,50],[1,804,53,12],[1,805,53,14,"loaded"],[1,813,53,22],[1,816,55,4],[1,817,55,6],[1,823,56,6,"set"],[1,825,56,10],[1,826,56,12,"loaded"],[1,834,56,20],[1,837,57,4],[1,840,61,2,"loadFromAPI"],[1,852,61,15,"async"],[1,862,62,4],[1,866,62,9,"isAuthenticated"],[1,870,65,6],[1,877,63,6,"console"],[1,885,63,14,"log"],[1,889,63,18],[1,971,64,12,"get"],[1,975,64,18,"loadFromStorage"],[1,993,68,4,"set"],[1,995,68,8],[1,996,68,10,"isLoading"],[1,1007,68,21],[1,1011,70,4],[1,1015,71,6,"console"],[1,1023,71,14,"log"],[1,1027,71,18],[1,1088,74,6],[1,1094,75,12,"data"],[1,1103,74,29,"api"],[1,1105,74,32,"default"],[1,1113,74,33,"get"],[1,1117,74,37],[1,1142,75,28,"data"],[1,1147,78,6],[1,1151,78,10,"stations"],[1,1153,78,21,"Array"],[1,1159,78,27,"isArray"],[1,1167,78,35,"data"],[1,1170,78,43,"data"],[1,1172,78,51,"data"],[1,1174,78,56,"stations"],[1,1184,78,68],[1,1187,81,6],[1,1193,81,12,"seenIds"],[1,1195,81,22],[1,1199,81,26,"Set"],[1,1203,82,6,"stations"],[1,1205,82,17,"stations"],[1,1207,82,26,"filter"],[1,1214,82,34,"s"],[1,1217,83,12,"seenIds"],[1,1219,83,20,"has"],[1,1223,83,24,"s"],[1,1225,83,26,"_id"],[1,1231,84,10,"console"],[1,1239,84,18,"log"],[1,1243,84,22],[1,1295,84,75,"s"],[1,1297,84,77,"_id"],[1,1303,85,17],[1,1307,87,8,"seenIds"],[1,1309,87,16,"add"],[1,1313,87,20,"s"],[1,1315,87,22,"_id"],[1,1321,88,15],[1,1325,91,6,"console"],[1,1333,91,14,"log"],[1,1337,91,18],[1,1374,91,56,"stations"],[1,1376,91,65,"length"],[1,1383,91,73],[1,1402,94,6],[1,1408,94,12,"localData"],[1,1416,94,30,"AsyncStorage"],[1,1418,94,42,"default"],[1,1426,94,43,"getItem"],[1,1434,94,51,"STORAGE_KEY"],[1,1437,95,12,"localStations"],[1,1439,95,39,"localData"],[1,1441,95,51,"JSON"],[1,1446,95,56,"parse"],[1,1452,95,62,"localData"],[1,1455,95,75],[1,1458,98,12,"apiIds"],[1,1460,98,21],[1,1464,98,25,"Set"],[1,1468,98,29,"stations"],[1,1470,98,38,"map"],[1,1474,98,43,"s"],[1,1477,98,58,"s"],[1,1479,98,60,"_id"],[1,1485,99,12,"localOnly"],[1,1487,99,24,"localStations"],[1,1489,99,38,"filter"],[1,1496,99,45,"s"],[1,1500,99,51,"apiIds"],[1,1502,99,58,"has"],[1,1506,99,62,"s"],[1,1508,99,64,"_id"],[1,1514,100,12,"merged"],[1,1516,100,21],[1,1520,100,25,"stations"],[1,1525,100,38,"localOnly"],[1,1528,100,49,"slice"],[1,1534,100,55],[1,1536,8,19],[1,1540,102,6,"set"],[1,1542,102,10],[1,1543,102,12,"stations"],[1,1552,102,22,"merged"],[1,1554,102,30,"loaded"],[1,1562,102,38],[1,1564,102,44,"isLoading"],[1,1575,102,55],[1,1585,105,12,"AsyncStorage"],[1,1587,105,24,"default"],[1,1595,105,25,"setItem"],[1,1603,105,33,"STORAGE_KEY"],[1,1605,105,46,"JSON"],[1,1610,105,51,"stringify"],[1,1620,105,61,"merged"],[1,1623,106,4],[1,1624,106,6],[1,1630,106,13,"error"],[1,1633,107,6,"console"],[1,1641,107,14,"error"],[1,1647,107,20],[1,1695,107,69,"error"],[1,1704,108,12,"get"],[1,1708,108,18,"loadFromStorage"],[1,1726,109,6,"set"],[1,1728,109,10],[1,1729,109,12,"isLoading"],[1,1740,109,23],[1,1743,110,4],[1,1746,114,2,"syncToAPI"],[1,1756,114,13,"async"],[1,1766,115,4],[1,1769,115,9,"isAuthenticated"],[1,1773,120,4],[1,1777,121,6,"console"],[1,1785,121,14,"log"],[1,1789,121,18],[1,1837,121,67,"stationId"],[1,1846,124,12,"api"],[1,1848,124,15,"default"],[1,1856,124,16,"post"],[1,1861,124,21],[1,1884,124,45],[1,1885,124,47,"stationId"],[1,1899,126,6,"console"],[1,1907,126,14,"log"],[1,1911,126,18],[1,1962,127,4],[1,1963,127,6],[1,1969,127,13,"error"],[1,1972,128,6,"console"],[1,1980,128,14,"error"],[1,1986,128,20],[1,2032,128,67,"error"],[1,2034,129,4],[1,2040,116,6,"console"],[1,2048,116,14,"log"],[1,2052,116,18],[1,2118,134,0,"useAuthStore"],[1,2120,134,12,"useAuthStore"],[1,2133,134,13,"subscribe"],[1,2143,134,23],[1,2144,134,24,"state"],[1,2146,134,31,"prevState"],[1,2151,136,6,"state"],[1,2153,136,12,"isAuthenticated"],[1,2171,136,32,"prevState"],[1,2173,136,42,"isAuthenticated"],[1,2191,137,4,"console"],[1,2199,137,12,"log"],[1,2203,137,16],[1,2262,139,4,"useRecentlyPlayedStore"],[1,2264,139,27,"setState"],[1,2273,139,36],[1,2274,139,38,"loaded"],[1,2282,139,46],[1,2286,140,4,"useRecentlyPlayedStore"],[1,2288,140,27,"getState"],[1,2299,140,38,"loadFromAPI"],[1,2316,144,0],[1,2320,144,0,"_default"],[1,2322,144,15,"useRecentlyPlayedStore"],[1,2323,144,38],[1,2326]],"functionMap":{"names":["<global>","isAuthenticated","create$argument_0","addStation","current.filter$argument_0","AsyncStorage.setItem._catch$argument_0","loadFromStorage","loadFromAPI","stations.filter$argument_0","stations.map$argument_0","localStations.filter$argument_0","syncToAPI","useAuthStore.subscribe$argument_0"],"mappings":"AAA;wBCoB;CDE;kEEE;cCK;oCCG,0BD;qEEK,QF;GDM;mBIE;GJY;eKG;iCCqB;ODO;0CES,qBF;6CGC,uBH;GLY;aSG;GTgB;EFC;uBYG;CZQ"},"hasCjsExports":false},"type":"js/module"}]}